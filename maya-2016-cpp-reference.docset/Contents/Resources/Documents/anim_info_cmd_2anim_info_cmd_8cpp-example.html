<!-- saved from url=(0024)http://docs.autodesk.com -->
<html>
<head><script src="../scripts/yepnope.1.5.4-min.js" type="text/javascript"></script><script src="../scripts/lib/jquery-1.11.1.min.js" type="text/javascript"></script><meta content="text/html; charset=utf-8" http-equiv="Content-Type"><meta content="MAYAUL" name="product"><meta content="2016" name="release"><meta content="Developer" name="book"><meta content="2015-10-14" name="created"><meta content="GUID-02DEF634-1E7B-48C6-8ACD-2C934CA97887" name="topicid"><meta content="concept" name="topic-type">
<title>animInfoCmd/animInfoCmd.cpp</title>
<meta content="C++" name="topic-subtype"/></meta></meta></meta></meta></meta></meta></meta></head>
<body height="100%"><div class="body_content" id="body-content"><link href="cpp_ref/navtree.css" rel="stylesheet" type="text/css"><link href="cpp_ref/doxygen.css" rel="stylesheet" type="text/css"><link href="cpp_ref/tabs.css" rel="stylesheet" type="text/css"><link href="style/adsk.cpm.css" rel="stylesheet" type="text/css"><script language="javascript">var index = 'index.html';</script><script>$(document).ready(function() { yepnope.injectJs("./scripts/ac_common.js"); });</script><script type="text/javascript">
var tocSystemNeedsToBeLoaded = typeof(cpp_ref_adsk_ref_toc) == 'undefined';
var weAreIn21 = $('div#main.view-active').length;
var tocPrefix = '';
if (weAreIn21)
{ tocPrefix = 'cpp_ref/'; }
function cpp_ref_initializeToc(forceTrigger) {
    cpp_ref_adsk_ref_toc.initResizable();
    cpp_ref_adsk_ref_toc.initNavTree('anim_info_cmd_2anim_info_cmd_8cpp-example.html', tocPrefix);
    dQuery(document).trigger('toc_initialized');
}
if (tocSystemNeedsToBeLoaded)
{
	yepnope([{
	load:[tocPrefix + 'json3.min.js', tocPrefix + 'jquery.js', tocPrefix + 'ref-toc-controller.js', tocPrefix + 'dynsections.js'],
	complete: function() {
	  if (typeof(dQuery) == 'undefined')
	  {
	    dQuery = jQuery.noConflict(true);
	  }
	  else { jQuery.noConflict(true); }
	  $(document).ready(cpp_ref_initializeToc);
	}
 	}])
}
if (!weAreIn21) { // if in AKN...
$(window).load( function() {
    setTimeout( function() {
        var content = $('body > div').not('#body-content');     // take any divs under body that are not id=body-content
        content.each( function() { 
            $(this).css( { 'padding-left': $(this).css('margin-left') } );       // and if they have any padding-left already, move it to margin-left.
        } );
        var width = cpp_ref_adsk_ref_toc.readFromStorage('width');
        content.css({marginLeft:parseInt(width)+6+"px"});
    }, 100);
} ); 
}
</script><script>$("div#WidgetFloaterPanels,link[href*='microsofttranslator.com'],script[src*='microsofttranslator.com'],script[src*='bing.com']").remove();</script><script type="text/javascript">$("div#navigation,div#breadcrumbs,div#banner").attr("translate","no"); var mtLocation = ((location && location.href && location.href.indexOf('https') == 0)?'https://ssl.microsofttranslator.com':'http://www.microsofttranslator.com')+'/ajax/v3/WidgetV3.ashx?siteData=y5CYlxTRD0znCzRLDwX0Wy7-g1EdC1XA4dSC-Y1LtaeScyli8_Ps5jPKqTr4xKxMI0OOUfkDplvX3uxN0JnPclebSYW8_J1HBzf4VLQEzQ8M4PsYXF_cMyp1Oumaetky&category=5297189e-446b-459e-ae1d-9d0360400781_tech&ctf=True&ui=true&settings=Manual&from=en&hidelanguages='; yepnope.injectJs(mtLocation, function() {}, { charset:'utf-8', type:'text/javascript' } );</script><script>
 if (!tocSystemNeedsToBeLoaded) { cpp_ref_initializeToc(); }
 </script><!-- begin MT -->
<div class="Dark" id="MicrosoftTranslatorWidget" style="position:absolute;right:20px;top:5px;z-index:100;color:white;background-color:#555555;height:58px;overflow:hidden"></div>
<div>
<div class="head">
<h1>animInfoCmd/animInfoCmd.cpp</h1>
</div>
<div id="top"><!-- Generated by Doxygen 1.8.10 -->
<div class="tabs" id="navrow1">
<ul class="tablist">
<li><a href="./index.html"><span>MainÂ Page</span></a></li>
<li><a href="./pages.html"><span>Topics</span></a></li>
<li><a href="./modules.html"><span>Modules</span></a></li>
<li><a href="./namespaces.html"><span>Namespaces</span></a></li>
<li><a href="./annotated.html"><span>Classes</span></a></li>
<li><a href="./examples.html"><span>Examples</span></a></li>
</ul>
</div>
</div><!-- top -->
<div class="ui-resizable side-nav-resizable" id="side-nav">
<div id="nav-tree">
<div id="nav-tree-contents">
<div class="sync" id="nav-sync"></div>
</div>
</div>
<div class="ui-resizable-handle" id="splitbar" style="-moz-user-select:none;">
</div>
</div>
<div id="doc-content">
<div class="header">
<div class="headertitle">
<div class="title">animInfoCmd/animInfoCmd.cpp</div> </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">//-</span></div>
<div class="line"><span class="comment">// ==========================================================================</span></div>
<div class="line"><span class="comment">// Copyright 1995,2006,2008 Autodesk, Inc. All rights reserved.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Use of this software is subject to the terms of the Autodesk</span></div>
<div class="line"><span class="comment">// license agreement provided at the time of installation or download,</span></div>
<div class="line"><span class="comment">// or which otherwise accompanies this software in either electronic</span></div>
<div class="line"><span class="comment">// or hard copy form.</span></div>
<div class="line"><span class="comment">// ==========================================================================</span></div>
<div class="line"><span class="comment">//+</span></div>
<div class="line"></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Write frame by frame values in a file in XML format.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Flags:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// -on/outputName &lt;string&gt;: Name of the output file. When not set, the</span></div>
<div class="line"><span class="comment">//      result goes into the standard output.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// -s/start &lt;frameNumber&gt;: Starting frame. When not set the start </span></div>
<div class="line"><span class="comment">//      frame is read from the render globals or the animation slider.</span></div>
<div class="line"><span class="comment">//      </span></div>
<div class="line"><span class="comment">// -e/end &lt;frameNumber&gt;: End frame. When not set the end </span></div>
<div class="line"><span class="comment">//      frame is read from the render globals or the animation slider.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// -by/byFrame &lt;frameNumber&gt;: Frame increment. When not set the </span></div>
<div class="line"><span class="comment">//      frame increment is read from the render globals or defaults to 1.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// -cam/camera &lt;name&gt;: Name of the camera to be tracked. Multiple</span></div>
<div class="line"><span class="comment">//      such flags can be used, resulting in several camera being</span></div>
<div class="line"><span class="comment">//      tracked. When not set, all the renderable cameras are tracked.</span></div>
<div class="line"><span class="comment">//      </span></div>
<div class="line"><span class="comment">// -p/plug &lt;name&gt;: Additionnal values tracked per frame. Any plug </span></div>
<div class="line"><span class="comment">//      name can be used.</span></div>
<div class="line"><span class="comment">//      </span></div>
<div class="line"><span class="comment">// Examples:</span></div>
<div class="line"><span class="comment">//      // Track two cameras, x translate and y rotation of object pCube1</span></div>
<div class="line"><span class="comment">//      animInfo -cam top -cam persp -p pCube1.tx -p pCube1.ry;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//      // Write renderable cameras into file /tmp/tstData, frame 1 to 10</span></div>
<div class="line"><span class="comment">//      animInfo -on "/tmp/tstData" -s 1 -e 10;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//      // Print renderable cameras into standard output. Frame range</span></div>
<div class="line"><span class="comment">//      // is read from the render global or the animation slider</span></div>
<div class="line"><span class="comment">//      // depending on user settings.</span></div>
<div class="line"><span class="comment">//      animInfo;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The command may take a long time to run. If it is aborted with the</span></div>
<div class="line"><span class="comment">// ESC key, the the current frame data is completed (Current &lt;TIME&gt;</span></div>
<div class="line"><span class="comment">// &lt;/TIME&gt; data, and an &lt;INTERRUPT&gt; tag is printed before closing the</span></div>
<div class="line"><span class="comment">// &lt;SEQUENCE&gt; data.</span></div>
<div class="line"><span class="comment">// </span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MGlobal.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MString.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MPoint.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MVector.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MFloatMatrix.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MTime.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MArgList.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MPlug.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MFnDependencyNode.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MFnCamera.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MDagPath.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MItDag.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MSelectionList.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MPlug.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MPlugArray.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MAnimControl.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MPxCommand.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MComputation.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MFnPlugin.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define mCommandName "animInfo"             // Command name</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define INDENT_STEP  2                      // Indentation steps</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define MAX_NB_PLUGS 100                    // Max number of plugs</span></div>
<div class="line"><span class="preprocessor">#define MAX_NB_CAM   32                     // Max number of camera</span></div>
<div class="line"><span class="preprocessor">#define FILE_TYPE    "Maya per frame data"  // File type</span></div>
<div class="line"><span class="preprocessor">#define VERSION_ID   0                      // Version number</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">char</span> * stIndentStr = <span class="stringliteral">"                                                "</span>;</div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span>animInfoCmd : <span class="keyword">public</span> <a name="_a0"></a><a class="code" href="./class_m_px_command.html">MPxCommand</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">                 animInfoCmd();</div>
<div class="line"> <span class="keyword">virtual</span>     ~animInfoCmd();</div>
<div class="line"></div>
<div class="line"> <span class="keyword">virtual</span> <a name="_a1"></a><a class="code" href="./class_m_status.html">MStatus</a> <a name="a2"></a><a class="code" href="./class_m_px_command.html#ade7d0a873cbe811d6eab464e695390a9">doIt</a> ( <span class="keyword">const</span> <a name="_a3"></a><a class="code" href="./class_m_arg_list.html">MArgList</a>&amp; args );</div>
<div class="line"></div>
<div class="line"> <span class="keyword">static</span> <span class="keywordtype">void</span>* creator();</div>
<div class="line"></div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line"> <span class="keyword">static</span> <a class="code" href="./class_m_status.html">MStatus</a> nodeFromName(<a name="_a4"></a><a class="code" href="./class_m_string.html">MString</a> name, <a name="_a5"></a><a class="code" href="./class_m_object.html">MObject</a> &amp; obj);</div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">char</span> * indent()<span class="keyword"> const </span>{<span class="keywordflow">return</span> stIndentStr+strlen(stIndentStr)-fIndent;}</div>
<div class="line"></div>
<div class="line"> <a class="code" href="./class_m_status.html">MStatus</a> parseArgs ( <span class="keyword">const</span> <a class="code" href="./class_m_arg_list.html">MArgList</a>&amp; args );</div>
<div class="line"> <span class="keywordtype">void</span> readSceneStartEnd();</div>
<div class="line"> <a class="code" href="./class_m_status.html">MStatus</a> writeFrameInfo( <span class="keywordtype">double</span> frame );</div>
<div class="line"> <a class="code" href="./class_m_status.html">MStatus</a> writeCameraInfo( <span class="keyword">const</span> <a name="_a6"></a><a class="code" href="./class_m_fn_camera.html">MFnCamera</a> &amp; cam );</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">double</span>      fStartFrame;</div>
<div class="line"> <span class="keywordtype">double</span>      fEndFrame;</div>
<div class="line"> <span class="keywordtype">double</span>      fByFrame;</div>
<div class="line"> <span class="keywordtype">int</span>         fIndent;</div>
<div class="line">    FILE *      fOutput;</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">int</span>         fNbCameraPath;</div>
<div class="line"> <a name="_a7"></a><a class="code" href="./class_m_dag_path.html">MDagPath</a>    fCameraPath[MAX_NB_CAM];</div>
<div class="line"></div>
<div class="line"> <span class="comment">// We cannot use MPlugArray, as MPlugArray::append does not copy</span></div>
<div class="line"> <span class="comment">// the MPlug object...</span></div>
<div class="line"> <span class="keywordtype">int</span>         fNbPlugs;</div>
<div class="line"> <a name="_a8"></a><a class="code" href="./class_m_plug.html">MPlug</a>       fPlugs[MAX_NB_PLUGS];</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line">animInfoCmd::animInfoCmd() :</div>
<div class="line">    fStartFrame(-1),</div>
<div class="line">    fEndFrame  (-2),</div>
<div class="line">    fByFrame   ( 1),</div>
<div class="line">    fIndent    (INDENT_STEP),</div>
<div class="line">    fOutput    (stdout),</div>
<div class="line">    fNbCameraPath(0),</div>
<div class="line">    fNbPlugs   (0)</div>
<div class="line">{}</div>
<div class="line"></div>
<div class="line">animInfoCmd::~animInfoCmd() {}</div>
<div class="line"></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><a class="code" href="./class_m_status.html">MStatus</a> animInfoCmd::nodeFromName(<a class="code" href="./class_m_string.html">MString</a> name, <a class="code" href="./class_m_object.html">MObject</a> &amp; obj)</div>
<div class="line">{</div>
<div class="line"> <a name="_a9"></a><a class="code" href="./class_m_selection_list.html">MSelectionList</a> tempList;</div>
<div class="line">    tempList.<a name="a10"></a><a class="code" href="./class_m_selection_list.html#a23929aeafb29672f2652128eac9c4dec">add</a>( name );</div>
<div class="line"> <span class="keywordflow">if</span> ( tempList.<a name="a11"></a><a class="code" href="./class_m_selection_list.html#a99dd6a54b909ede1d11702fe58977e2a">length</a>() &gt; 0 ) </div>
<div class="line">    {</div>
<div class="line">        tempList.<a name="a12"></a><a class="code" href="./class_m_selection_list.html#a72d8cd9c78fd234dcf68cd2fb70bc432">getDependNode</a>( 0, obj );</div>
<div class="line"> <span class="keywordflow">return</span> <a name="a13"></a><a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80af0536797208144380691e2b376ffc1d1">MS::kSuccess</a>;</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">return</span> <a name="a14"></a><a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80a1ef6c2d725fb4bec3e7e840d28adbc00">MS::kFailure</a>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Read the arguments, and make sure they are consistant</span></div>
<div class="line"><span class="comment"></span><span class="preprocessor">#define MATCH(str, shortName, longName) \</span></div>
<div class="line"><span class="preprocessor">        (((str)==(shortName))||((str)==(longName)))</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> stringArg(<span class="keyword">const</span> <a class="code" href="./class_m_arg_list.html">MArgList</a>&amp; args, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp;indx, <a class="code" href="./class_m_string.html">MString</a> &amp; res)</div>
<div class="line">{</div>
<div class="line"> <span class="keywordflow">if</span> (indx &lt; args.<a name="a15"></a><a class="code" href="./class_m_arg_list.html#a99dd6a54b909ede1d11702fe58977e2a">length</a>())</div>
<div class="line">    {</div>
<div class="line"> <a class="code" href="./class_m_status.html">MStatus</a> stat;</div>
<div class="line">        indx++;</div>
<div class="line">        res = args.<a name="a16"></a><a class="code" href="./class_m_arg_list.html#ad24ff3826e4df513b55e1a0ecb0a665b">asString</a>( indx, &amp;stat );</div>
<div class="line"> <span class="keywordflow">if</span> (stat == <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80af0536797208144380691e2b376ffc1d1">MS::kSuccess</a>) </div>
<div class="line"> <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> doubleArg(<span class="keyword">const</span> <a class="code" href="./class_m_arg_list.html">MArgList</a>&amp; args, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp;indx, <span class="keywordtype">double</span> &amp; res)</div>
<div class="line">{</div>
<div class="line"> <span class="keywordflow">if</span> (indx &lt; args.<a class="code" href="./class_m_arg_list.html#a99dd6a54b909ede1d11702fe58977e2a">length</a>())</div>
<div class="line">    {</div>
<div class="line"> <a class="code" href="./class_m_status.html">MStatus</a> stat;</div>
<div class="line">        indx++;</div>
<div class="line">        res = args.<a name="a17"></a><a class="code" href="./class_m_arg_list.html#a15a33f5705d13873ab7f003bb64f0741">asDouble</a>( indx, &amp;stat );</div>
<div class="line"> <span class="keywordflow">if</span> (stat == <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80af0536797208144380691e2b376ffc1d1">MS::kSuccess</a>) </div>
<div class="line"> <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// this method currently unused</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// static int intArg(const MArgList&amp; args, unsigned int &amp;indx, int &amp; res)</span></div>
<div class="line"><span class="comment">// {</span></div>
<div class="line"><span class="comment">//  if (indx &lt; args.length())</span></div>
<div class="line"><span class="comment">//  {</span></div>
<div class="line"><span class="comment">//      MStatus stat;</span></div>
<div class="line"><span class="comment">//      indx++;</span></div>
<div class="line"><span class="comment">//      res = args.asInt( indx, &amp;stat );</span></div>
<div class="line"><span class="comment">//      if (stat == MS::kSuccess) </span></div>
<div class="line"><span class="comment">//          return 1;</span></div>
<div class="line"><span class="comment">//  }</span></div>
<div class="line"><span class="comment">//  return 0;</span></div>
<div class="line"><span class="comment">// }</span></div>
<div class="line"></div>
<div class="line"><a class="code" href="./class_m_status.html">MStatus</a> animInfoCmd::parseArgs( <span class="keyword">const</span> <a class="code" href="./class_m_arg_list.html">MArgList</a>&amp; args )</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// Parse the arguments.</span></div>
<div class="line"> <a class="code" href="./class_m_string.html">MString</a> arg;</div>
<div class="line"> <a class="code" href="./class_m_status.html">MStatus</a> stat = <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80af0536797208144380691e2b376ffc1d1">MS::kSuccess</a>;</div>
<div class="line"> <a class="code" href="./class_m_string.html">MString</a> str;</div>
<div class="line"> <a class="code" href="./class_m_object.html">MObject</a> cameraNode;</div>
<div class="line"> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">for</span> ( i = 0; i &lt; args.<a class="code" href="./class_m_arg_list.html#a99dd6a54b909ede1d11702fe58977e2a">length</a>(); i++ ) {</div>
<div class="line">        arg = args.<a class="code" href="./class_m_arg_list.html#ad24ff3826e4df513b55e1a0ecb0a665b">asString</a>( i, &amp;stat );</div>
<div class="line"> <span class="keywordflow">if</span> (stat != <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80af0536797208144380691e2b376ffc1d1">MS::kSuccess</a>)</div>
<div class="line"> <span class="keywordflow">continue</span>;</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (MATCH(arg, <span class="stringliteral">"-on"</span>, <span class="stringliteral">"-outputName"</span>) &amp;&amp; stringArg(args, i, str))</div>
<div class="line">        {</div>
<div class="line">            FILE *f;</div>
<div class="line"> <span class="keywordflow">if</span> ( NULL != (f = fopen(str.<a name="a18"></a><a class="code" href="./class_m_string.html#aa9ab612f356c53479afc4c648c9ef94d">asChar</a>(), <span class="stringliteral">"w"</span>)))</div>
<div class="line">                fOutput = f;</div>
<div class="line"> <span class="keywordflow">else</span> </div>
<div class="line">            {</div>
<div class="line">                fprintf(stderr, <span class="stringliteral">"cannot open '%s'\n"</span>, str.<a class="code" href="./class_m_string.html#aa9ab612f356c53479afc4c648c9ef94d">asChar</a>());</div>
<div class="line">                fflush(stderr);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> <span class="keywordflow">else</span> <span class="keywordflow">if</span> (MATCH(arg, <span class="stringliteral">"-s"</span>, <span class="stringliteral">"-start"</span>))</div>
<div class="line">            doubleArg(args, i, fStartFrame);</div>
<div class="line"> <span class="keywordflow">else</span> <span class="keywordflow">if</span> (MATCH(arg, <span class="stringliteral">"-e"</span>, <span class="stringliteral">"-end"</span>))</div>
<div class="line">            doubleArg(args, i, fEndFrame);</div>
<div class="line"> <span class="keywordflow">else</span> <span class="keywordflow">if</span> (MATCH(arg, <span class="stringliteral">"-by"</span>, <span class="stringliteral">"-byFrame"</span>))</div>
<div class="line">            doubleArg(args, i, fByFrame);</div>
<div class="line"> <span class="keywordflow">else</span> <span class="keywordflow">if</span> (MATCH(arg, <span class="stringliteral">"-cam"</span>, <span class="stringliteral">"-camera"</span>) &amp;&amp; stringArg(args, i, str))</div>
<div class="line">        {</div>
<div class="line"> <span class="keywordflow">if</span> (fNbCameraPath &gt;= MAX_NB_CAM)</div>
<div class="line"> <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">            nodeFromName(str, cameraNode);</div>
<div class="line"> <a class="code" href="./class_m_status.html">MStatus</a> status;</div>
<div class="line"> <a name="a19"></a><a class="code" href="./class_m_dag_path.html#a422aa5ec02565f757c13fe2873ed25d7">MDagPath::getAPathTo</a>(cameraNode, fCameraPath[fNbCameraPath]);</div>
<div class="line">            fCameraPath[fNbCameraPath].extendToShape();</div>
<div class="line"> <a class="code" href="./class_m_fn_camera.html">MFnCamera</a> cam(fCameraPath[fNbCameraPath], &amp;status);</div>
<div class="line"> <span class="keywordflow">if</span> (status == <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80af0536797208144380691e2b376ffc1d1">MS::kSuccess</a>)</div>
<div class="line">                fNbCameraPath++;</div>
<div class="line"> </div>
<div class="line">        }</div>
<div class="line"> <span class="keywordflow">else</span> <span class="keywordflow">if</span> (MATCH(arg, <span class="stringliteral">"-p"</span>, <span class="stringliteral">"-plug"</span>) &amp;&amp; stringArg(args, i, str))</div>
<div class="line">        {</div>
<div class="line"> <a class="code" href="./class_m_selection_list.html">MSelectionList</a> plugList;</div>
<div class="line">            plugList.<a class="code" href="./class_m_selection_list.html#a23929aeafb29672f2652128eac9c4dec">add</a>( str );</div>
<div class="line"> <span class="comment">// Find the plugs out of the names in the selectionList</span></div>
<div class="line"> <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0 ; k&lt;plugList.<a class="code" href="./class_m_selection_list.html#a99dd6a54b909ede1d11702fe58977e2a">length</a>() ; k++)</div>
<div class="line">            {</div>
<div class="line"> <span class="keywordflow">if</span> (fNbPlugs &gt;= MAX_NB_PLUGS)</div>
<div class="line"> <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (plugList.<a name="a20"></a><a class="code" href="./class_m_selection_list.html#a4cdb668fdd6feafe9b296a80cfca26f0">getPlug</a>(k, fPlugs[fNbPlugs]) == <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80af0536797208144380691e2b376ffc1d1">MS::kSuccess</a>)</div>
<div class="line">                    fNbPlugs++;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            fprintf(stderr, <span class="stringliteral">"Unknown argument '%s'\n"</span>, arg.<a class="code" href="./class_m_string.html#aa9ab612f356c53479afc4c648c9ef94d">asChar</a>());</div>
<div class="line">            fflush(stderr);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (fByFrame&lt;=0) fByFrame = 1;</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (fNbCameraPath == 0)</div>
<div class="line">    {</div>
<div class="line"> <span class="comment">// User did not specify a valid camera. Find one.</span></div>
<div class="line"> <a name="_a21"></a><a class="code" href="./class_m_it_dag.html">MItDag</a> dagIterator( <a name="a22"></a><a class="code" href="./class_m_it_dag.html#a1545968b4f810358b53ae9844bce6bd1a6e92a8757afce03be51397f0b518f4c5">MItDag::kDepthFirst</a>, <a name="a23"></a><a class="code" href="./class_m_fn.html#a1d1cfd8ffb84e947f82999c682b666a7af2731fae06310295129a8fb3dba5fbb2">MFn::kCamera</a>);</div>
<div class="line"> <span class="keywordflow">for</span> (; !dagIterator.isDone(); dagIterator.next())</div>
<div class="line">        {</div>
<div class="line"> <span class="keywordflow">if</span> (fNbCameraPath &gt;= MAX_NB_CAM)</div>
<div class="line"> <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">bool</span>        renderable;</div>
<div class="line"> <span class="keywordflow">if</span> ( !dagIterator.getPath(fCameraPath[fNbCameraPath]) )</div>
<div class="line"> <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">            renderable = <span class="keyword">false</span>;</div>
<div class="line"> <a class="code" href="./class_m_fn_camera.html">MFnCamera</a> fnCameraNode( fCameraPath[fNbCameraPath] );</div>
<div class="line">            fnCameraNode.findPlug( <span class="stringliteral">"renderable"</span> ).getValue( renderable );</div>
<div class="line"> </div>
<div class="line"> <span class="keywordflow">if</span> (renderable)</div>
<div class="line">                fNbCameraPath++;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">return</span> <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80af0536797208144380691e2b376ffc1d1">MS::kSuccess</a>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> animInfoCmd::readSceneStartEnd()</div>
<div class="line">{</div>
<div class="line"> <a name="_a24"></a><a class="code" href="./class_m_time.html">MTime</a> startFrame;</div>
<div class="line"> <a class="code" href="./class_m_time.html">MTime</a> endFrame;</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Get the render globals node</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line"> <span class="keywordtype">int</span> rangeIsSet = 0;</div>
<div class="line"> <a class="code" href="./class_m_object.html">MObject</a> renderGlobNode;</div>
<div class="line"> <span class="keywordflow">if</span> (nodeFromName(<span class="stringliteral">"defaultRenderGlobals"</span>, renderGlobNode) == <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80af0536797208144380691e2b376ffc1d1">MS::kSuccess</a>)</div>
<div class="line">    {</div>
<div class="line"> <a name="_a25"></a><a class="code" href="./class_m_fn_dependency_node.html">MFnDependencyNode</a> fnRenderGlobals( renderGlobNode );</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Check if the time-slider or renderGlobals is used for </span></div>
<div class="line"> <span class="comment">// the frame range</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line"> <a class="code" href="./class_m_plug.html">MPlug</a> animPlug = fnRenderGlobals.findPlug( <span class="stringliteral">"animation"</span> );</div>
<div class="line"> <span class="keywordtype">short</span> anim;</div>
<div class="line">        animPlug.<a name="a26"></a><a class="code" href="./class_m_plug.html#a64f7093bfde5c5eb9d89b32635b772aa">getValue</a>( anim );</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> ( anim ) {</div>
<div class="line"> <span class="keywordtype">float</span> byFrame;</div>
<div class="line">            fnRenderGlobals.findPlug( <span class="stringliteral">"startFrame"</span>  ).getValue(startFrame);</div>
<div class="line">            fnRenderGlobals.findPlug( <span class="stringliteral">"endFrame"</span>    ).getValue(endFrame);</div>
<div class="line">            fnRenderGlobals.findPlug( <span class="stringliteral">"byFrameStep"</span> ).getValue(byFrame);</div>
<div class="line">            fByFrame = (double) byFrame;</div>
<div class="line">            rangeIsSet = 1;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> <span class="keywordflow">if</span> (!rangeIsSet)    {</div>
<div class="line"> <span class="comment">// USE_TIMESLIDER</span></div>
<div class="line">        startFrame = <a name="a27"></a><a class="code" href="./class_m_anim_control.html#a23de291893fb7de1ee4cd3e40011ed8a">MAnimControl::minTime</a>();</div>
<div class="line">        endFrame   = <a name="a28"></a><a class="code" href="./class_m_anim_control.html#a7ad7000520c1ac526339afd6432ef6bf">MAnimControl::maxTime</a>();</div>
<div class="line">        fByFrame = 1;</div>
<div class="line">    }</div>
<div class="line">    fStartFrame = (int) startFrame.<a name="a29"></a><a class="code" href="./class_m_time.html#a105d41236561f4d4be6383ced757a429">as</a>( <a name="a30"></a><a class="code" href="./class_m_time.html#a5b08f84ff68e42c0a32dbd8e0a2d6506">MTime::uiUnit</a>() );</div>
<div class="line">    fEndFrame   = (int)   endFrame.<a class="code" href="./class_m_time.html#a105d41236561f4d4be6383ced757a429">as</a>( <a class="code" href="./class_m_time.html#a5b08f84ff68e42c0a32dbd8e0a2d6506">MTime::uiUnit</a>() );</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Print info for a given time frame</span></div>
<div class="line"><span class="comment"></span><a class="code" href="./class_m_status.html">MStatus</a> animInfoCmd::writeFrameInfo( <span class="keywordtype">double</span> frame )</div>
<div class="line">{</div>
<div class="line"> <span class="keywordtype">int</span> i;</div>
<div class="line"> <a class="code" href="./class_m_status.html">MStatus</a> status;</div>
<div class="line"> <a name="a31"></a><a class="code" href="./class_m_global.html#ac919b5ecda7f12015e94792c0712726f">MGlobal::viewFrame</a> (frame);             <span class="comment">// Set the current frame</span></div>
<div class="line"></div>
<div class="line">    fprintf(fOutput, <span class="stringliteral">"%s&lt;TIME VAL=%g&gt;\n"</span>, indent(), frame);</div>
<div class="line">    fIndent += INDENT_STEP;</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">for</span> (i = 0 ; i&lt;fNbCameraPath ; i++)</div>
<div class="line">    {</div>
<div class="line"> <a class="code" href="./class_m_fn_camera.html">MFnCamera</a> cam(fCameraPath[i], &amp;status);</div>
<div class="line"> <span class="keywordflow">if</span> (status == <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80af0536797208144380691e2b376ffc1d1">MS::kSuccess</a>)</div>
<div class="line">            writeCameraInfo(cam);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">double</span> val;</div>
<div class="line"> <span class="keywordflow">for</span> (i = 0 ; i&lt;fNbPlugs ; i++)</div>
<div class="line">    {</div>
<div class="line"> <span class="keywordflow">if</span> (fPlugs[i].getValue(val) == <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80af0536797208144380691e2b376ffc1d1">MS::kSuccess</a>)</div>
<div class="line">            fprintf(fOutput, <span class="stringliteral">"%s&lt;PARAM NAME=\"%s\" VAL=%lg&gt;\n"</span>, </div>
<div class="line">                    indent(), fPlugs[i].name().asChar(), val);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    fIndent -= INDENT_STEP;</div>
<div class="line">    fprintf(fOutput, <span class="stringliteral">"%s&lt;/TIME&gt;\n"</span>, indent());</div>
<div class="line"> <span class="keywordflow">return</span> <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80af0536797208144380691e2b376ffc1d1">MS::kSuccess</a>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Print info for a given time frame</span></div>
<div class="line"><span class="comment"></span><a class="code" href="./class_m_status.html">MStatus</a> animInfoCmd::writeCameraInfo( <span class="keyword">const</span> <a class="code" href="./class_m_fn_camera.html">MFnCamera</a> &amp; cam )</div>
<div class="line">{</div>
<div class="line"> <a class="code" href="./class_m_status.html">MStatus</a> status;</div>
<div class="line">    fprintf(fOutput, <span class="stringliteral">"%s&lt;CAMERA NAME=\"%s\"&gt;\n"</span>, </div>
<div class="line">            indent(), cam.<a name="a32"></a><a class="code" href="./class_m_fn_dependency_node.html#a049384adbea0396ea2f03d1ad4d69df1">name</a>().<a class="code" href="./class_m_string.html#aa9ab612f356c53479afc4c648c9ef94d">asChar</a>());</div>
<div class="line">    fIndent += INDENT_STEP;</div>
<div class="line"></div>
<div class="line"> <a name="_a33"></a><a class="code" href="./class_m_point.html">MPoint</a> pt = cam.<a name="a34"></a><a class="code" href="./class_m_fn_camera.html#a578aa1d086c52784f1c5e7b204f70a9d">eyePoint</a>(<a name="a35"></a><a class="code" href="./class_m_space.html#ab11a1dda34491acff014ddfc9e6bafb8a45a60f04ac9114f0d6e865a6285f40b2">MSpace::kWorld</a>, &amp;status);</div>
<div class="line">    fprintf(fOutput, <span class="stringliteral">"%s&lt;EYE X=%g Y=%g Z=%g&gt;\n"</span>, indent(), pt.<a name="a36"></a><a class="code" href="./class_m_point.html#af88b946fb90d5f08b5fb740c70e98c10">x</a>, pt.<a name="a37"></a><a class="code" href="./class_m_point.html#ab927965981178aa1fba979a37168db2a">y</a>, pt.<a name="a38"></a><a class="code" href="./class_m_point.html#ab3e6ed577a7c669c19de1f9c1b46c872">z</a>);</div>
<div class="line"></div>
<div class="line"> <a name="_a39"></a><a class="code" href="./class_m_vector.html">MVector</a> v = cam.<a name="a40"></a><a class="code" href="./class_m_fn_camera.html#a8607e1142843f35474557b5daa9489de">viewDirection</a>(<a class="code" href="./class_m_space.html#ab11a1dda34491acff014ddfc9e6bafb8a45a60f04ac9114f0d6e865a6285f40b2">MSpace::kWorld</a>);</div>
<div class="line">    fprintf(fOutput, <span class="stringliteral">"%s&lt;DIR X=%g Y=%g Z=%g&gt;\n"</span>, indent(), v.<a name="a41"></a><a class="code" href="./class_m_vector.html#af88b946fb90d5f08b5fb740c70e98c10">x</a>, v.<a name="a42"></a><a class="code" href="./class_m_vector.html#ab927965981178aa1fba979a37168db2a">y</a>, v.<a name="a43"></a><a class="code" href="./class_m_vector.html#ab3e6ed577a7c669c19de1f9c1b46c872">z</a>);</div>
<div class="line"></div>
<div class="line">    v = cam.<a name="a44"></a><a class="code" href="./class_m_fn_camera.html#a02c40747377d923d863cc514ef0b4d3d">upDirection</a>(<a class="code" href="./class_m_space.html#ab11a1dda34491acff014ddfc9e6bafb8a45a60f04ac9114f0d6e865a6285f40b2">MSpace::kWorld</a>);</div>
<div class="line">    fprintf(fOutput, <span class="stringliteral">"%s&lt;UP X=%g Y=%g Z=%g&gt;\n"</span>, indent(), v.<a class="code" href="./class_m_vector.html#af88b946fb90d5f08b5fb740c70e98c10">x</a>, v.<a class="code" href="./class_m_vector.html#ab927965981178aa1fba979a37168db2a">y</a>, v.<a class="code" href="./class_m_vector.html#ab3e6ed577a7c669c19de1f9c1b46c872">z</a>);</div>
<div class="line"></div>
<div class="line">    v = cam.<a name="a45"></a><a class="code" href="./class_m_fn_camera.html#a12417c673de907852f1d2917106b6097">rightDirection</a>(<a class="code" href="./class_m_space.html#ab11a1dda34491acff014ddfc9e6bafb8a45a60f04ac9114f0d6e865a6285f40b2">MSpace::kWorld</a>);</div>
<div class="line">    fprintf(fOutput, <span class="stringliteral">"%s&lt;RIGHT X=%g Y=%g Z=%g&gt;\n"</span>, indent(), v.<a class="code" href="./class_m_vector.html#af88b946fb90d5f08b5fb740c70e98c10">x</a>, v.<a class="code" href="./class_m_vector.html#ab927965981178aa1fba979a37168db2a">y</a>, v.<a class="code" href="./class_m_vector.html#ab3e6ed577a7c669c19de1f9c1b46c872">z</a>);</div>
<div class="line"></div>
<div class="line">    pt = cam.<a name="a46"></a><a class="code" href="./class_m_fn_camera.html#ad3db6fc8bade6bad673149a026b3909d">centerOfInterestPoint</a>(<a class="code" href="./class_m_space.html#ab11a1dda34491acff014ddfc9e6bafb8a45a60f04ac9114f0d6e865a6285f40b2">MSpace::kWorld</a>, &amp;status);</div>
<div class="line"> <span class="keywordflow">if</span> (status == <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80af0536797208144380691e2b376ffc1d1">MS::kSuccess</a>)</div>
<div class="line">        fprintf(fOutput, <span class="stringliteral">"%s&lt;COI X=%g Y=%g Z=%g&gt;\n"</span>, indent(), pt.<a class="code" href="./class_m_point.html#af88b946fb90d5f08b5fb740c70e98c10">x</a>,pt.<a class="code" href="./class_m_point.html#ab927965981178aa1fba979a37168db2a">y</a>,pt.<a class="code" href="./class_m_point.html#ab3e6ed577a7c669c19de1f9c1b46c872">z</a>);</div>
<div class="line"> <span class="keywordflow">else</span></div>
<div class="line">        fprintf(fOutput, <span class="stringliteral">"%s&lt;COI NONE&gt;\n"</span>, indent());</div>
<div class="line"></div>
<div class="line">    fprintf(fOutput, <span class="stringliteral">"%s&lt;ASPECTRATIO VAL=%g&gt;\n"</span>, indent(), cam.<a name="a47"></a><a class="code" href="./class_m_fn_camera.html#af11d13387756845072bb5dd022015331">aspectRatio</a>());</div>
<div class="line">    fprintf(fOutput, <span class="stringliteral">"%s&lt;FSTOP VAL=%g&gt;\n"</span>, indent(), cam.<a name="a48"></a><a class="code" href="./class_m_fn_camera.html#a980387a4455b4e0b83433da1ce527590">fStop</a>());</div>
<div class="line">    fprintf(fOutput, <span class="stringliteral">"%s&lt;FOCALLENGTH VAL=%g&gt;\n"</span>, indent(), cam.<a name="a49"></a><a class="code" href="./class_m_fn_camera.html#af617dec322af443bb85257cf32da848e">focalLength</a>());</div>
<div class="line">    fprintf(fOutput, <span class="stringliteral">"%s&lt;FOCUS VAL=%g NEAR=%g FAR=%g&gt;\n"</span>, indent(),</div>
<div class="line">            cam.<a name="a50"></a><a class="code" href="./class_m_fn_camera.html#afaaef5decf2518f641e60d3e94b58036">focusDistance</a>(), </div>
<div class="line">            cam.<a name="a51"></a><a class="code" href="./class_m_fn_camera.html#a410b952035ea6410665f33c70f75252c">nearFocusDistance</a>(), cam.<a name="a52"></a><a class="code" href="./class_m_fn_camera.html#ab4def510ad65159d29e4f5f74425bc14">farFocusDistance</a>());</div>
<div class="line"></div>
<div class="line"> <a name="_a53"></a><a class="code" href="./class_m_float_matrix.html">MFloatMatrix</a> mat = cam.<a name="a54"></a><a class="code" href="./class_m_fn_camera.html#aa2b33367b6d31ae6bb0f2e51fafd609a">projectionMatrix</a>();</div>
<div class="line">    fprintf(fOutput, <span class="stringliteral">"%s&lt;MAT A00=%g A01=%g A02=%g A03=%g\n"</span>, indent(),</div>
<div class="line">            mat(0,0), mat(0,1), mat(0,2), mat(0,3));</div>
<div class="line">    fprintf(fOutput, <span class="stringliteral">"%s     A10=%g A11=%g A12=%g A13=%g\n"</span>, indent(),</div>
<div class="line">            mat(1,0), mat(1,1), mat(1,2), mat(1,3));</div>
<div class="line">    fprintf(fOutput, <span class="stringliteral">"%s     A20=%g A21=%g A22=%g A23=%g\n"</span>, indent(),</div>
<div class="line">            mat(2,0), mat(2,1), mat(2,2), mat(2,3));</div>
<div class="line">    fprintf(fOutput, <span class="stringliteral">"%s     A30=%g A31=%g A32=%g A33=%g&gt;\n"</span>, indent(),</div>
<div class="line">            mat(3,0), mat(3,1), mat(3,2), mat(3,3));</div>
<div class="line"></div>
<div class="line">    fIndent -= INDENT_STEP;</div>
<div class="line">    fprintf(fOutput, <span class="stringliteral">"%s&lt;/CAMERA&gt;\n"</span>, indent());</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">return</span> <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80af0536797208144380691e2b376ffc1d1">MS::kSuccess</a>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Main routine</span></div>
<div class="line"><span class="comment"></span><a class="code" href="./class_m_status.html">MStatus</a> animInfoCmd::doIt( <span class="keyword">const</span> <a class="code" href="./class_m_arg_list.html">MArgList</a>&amp; args )</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// parse the command arguments</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line"> <a class="code" href="./class_m_status.html">MStatus</a> stat = parseArgs(args);</div>
<div class="line"> <span class="keywordflow">if</span> (stat != <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80af0536797208144380691e2b376ffc1d1">MS::kSuccess</a>) {</div>
<div class="line"> <span class="keywordflow">if</span> (fOutput != stdout) </div>
<div class="line">            fclose(fOutput);</div>
<div class="line"> <span class="keywordflow">return</span> stat;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">if</span> (fStartFrame &gt; fEndFrame)</div>
<div class="line">        readSceneStartEnd();</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Remember the frame the scene was at so we can restore it later.</span></div>
<div class="line"> <a class="code" href="./class_m_time.html">MTime</a> currentFrame = <a name="a55"></a><a class="code" href="./class_m_anim_control.html#a8cb1e013d828c1d012fee789b14e0060">MAnimControl::currentTime</a>();</div>
<div class="line">    fprintf(fOutput, <span class="stringliteral">"&lt;FILE TYPE=\"%s\" VERSION=%d&gt;\n"</span>, FILE_TYPE, VERSION_ID);</div>
<div class="line">    fprintf(fOutput, <span class="stringliteral">"\n%s&lt;SEQUENCE START=%g END=%g STEP=%g&gt;\n"</span>, </div>
<div class="line">            indent(), fStartFrame, fEndFrame, fByFrame);</div>
<div class="line">    fIndent += INDENT_STEP;</div>
<div class="line"></div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">float</span> kMaxProgressRange = 100.0;</div>
<div class="line"> <a name="_a56"></a><a class="code" href="./class_m_computation.html">MComputation</a> computation;</div>
<div class="line">    computation.<a name="a57"></a><a class="code" href="./class_m_computation.html#a21a0632b8283a671cd8f90fd82a99843">beginComputation</a>( <span class="keyword">true</span> <span class="comment">/* use progress bar */</span> , <span class="keyword">true</span> <span class="comment">/* interruptable */</span> );</div>
<div class="line">    computation.<a name="a58"></a><a class="code" href="./class_m_computation.html#a805e0e9c09dc3b1c487aa4478366af12">setProgressRange</a>( 0, (<span class="keywordtype">int</span>) kMaxProgressRange );</div>
<div class="line">    computation.<a name="a59"></a><a class="code" href="./class_m_computation.html#ac2a2d2f07a4ee5c2be43aa080cdc721b">setProgress</a>( 0 );</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">for</span> (<span class="keywordtype">double</span> frame = fStartFrame ; frame &lt;= fEndFrame ; frame += fByFrame)</div>
<div class="line">    {</div>
<div class="line"> <span class="keywordflow">if</span> (computation.<a name="a60"></a><a class="code" href="./class_m_computation.html#ac8479086bd947ca42cd41eedbc922138">isInterruptRequested</a>())</div>
<div class="line">        {</div>
<div class="line">            fprintf(fOutput, <span class="stringliteral">"%s&lt;INTERRUPTION&gt;\n"</span>, indent());</div>
<div class="line">            break ;</div>
<div class="line">        }</div>
<div class="line">        writeFrameInfo(frame);</div>
<div class="line"></div>
<div class="line"> <span class="comment">// status bar update</span></div>
<div class="line"> <span class="keywordtype">int</span> amount = (int)(kMaxProgressRange * (frame - fStartFrame + 1) / (fEndFrame - fStartFrame + 1));</div>
<div class="line">        computation.<a class="code" href="./class_m_computation.html#ac2a2d2f07a4ee5c2be43aa080cdc721b">setProgress</a>( amount );</div>
<div class="line">    }</div>
<div class="line">    computation.<a name="a61"></a><a class="code" href="./class_m_computation.html#aaebee347f2af2f3a35b2ca106e4590f7">endComputation</a>();</div>
<div class="line"></div>
<div class="line">    fIndent -= INDENT_STEP;</div>
<div class="line">    fprintf(fOutput, <span class="stringliteral">"%s&lt;/SEQUENCE&gt;\n"</span>, indent());</div>
<div class="line"></div>
<div class="line">    fflush(fOutput);</div>
<div class="line"> <span class="keywordflow">if</span> (fOutput != stdout) </div>
<div class="line">        fclose(fOutput);</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Return to the frame we were at before we ran the animation</span></div>
<div class="line"> <a class="code" href="./class_m_global.html#ac919b5ecda7f12015e94792c0712726f">MGlobal::viewFrame</a> (currentFrame);</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">return</span> <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80af0536797208144380691e2b376ffc1d1">MS::kSuccess</a>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment"></span><span class="keywordtype">void</span> * animInfoCmd::creator() { <span class="keywordflow">return</span> <span class="keyword">new</span> animInfoCmd(); }</div>
<div class="line"></div>
<div class="line"><a class="code" href="./class_m_status.html">MStatus</a> initializePlugin( <a class="code" href="./class_m_object.html">MObject</a> obj )</div>
<div class="line">{</div>
<div class="line"> <a name="_a62"></a><a class="code" href="./class_m_fn_plugin.html">MFnPlugin</a> plugin( obj, PLUGIN_COMPANY, <span class="stringliteral">"4.0"</span>, <span class="stringliteral">"Any"</span>);</div>
<div class="line"></div>
<div class="line"> <a class="code" href="./class_m_status.html">MStatus</a> status = plugin.registerCommand(mCommandName,</div>
<div class="line">                                            animInfoCmd::creator );</div>
<div class="line"> <span class="keywordflow">if</span> (!status) status.<a name="a63"></a><a class="code" href="./class_m_status.html#a1f01a4748fea4d8bcced082df83f804d">perror</a>(<span class="stringliteral">"registerCommand"</span>);</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">return</span> status;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="./class_m_status.html">MStatus</a> uninitializePlugin( <a class="code" href="./class_m_object.html">MObject</a> obj )</div>
<div class="line">{</div>
<div class="line"> <a class="code" href="./class_m_fn_plugin.html">MFnPlugin</a> plugin( obj );</div>
<div class="line"></div>
<div class="line"> <a class="code" href="./class_m_status.html">MStatus</a> status = plugin.deregisterCommand(mCommandName);</div>
<div class="line"> <span class="keywordflow">if</span> (!status) status.<a class="code" href="./class_m_status.html#a1f01a4748fea4d8bcced082df83f804d">perror</a>(<span class="stringliteral">"deregisterCommand"</span>);</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">return</span> status;</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<div class="footer-block"><a class="comments-anchor" href="../html/ac.cmtdialog.htm" target="_blank"><span class="comments-link">Please send us your comment about this page</span></a></div><br/></div>
</link></link></link></link></div></body>
</html>
