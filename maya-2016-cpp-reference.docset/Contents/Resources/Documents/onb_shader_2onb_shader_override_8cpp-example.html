<!-- saved from url=(0024)http://docs.autodesk.com -->
<html>
<head><script src="../scripts/yepnope.1.5.4-min.js" type="text/javascript"></script><script src="../scripts/lib/jquery-1.11.1.min.js" type="text/javascript"></script><meta content="text/html; charset=utf-8" http-equiv="Content-Type"><meta content="MAYAUL" name="product"><meta content="2016" name="release"><meta content="Developer" name="book"><meta content="2015-10-14" name="created"><meta content="GUID-02DEF634-1E7B-48C6-8ACD-2C934CA97887" name="topicid"><meta content="concept" name="topic-type">
<title>onbShader/onbShaderOverride.cpp</title>
<meta content="C++" name="topic-subtype"/></meta></meta></meta></meta></meta></meta></meta></head>
<body height="100%"><div class="body_content" id="body-content"><link href="cpp_ref/navtree.css" rel="stylesheet" type="text/css"><link href="cpp_ref/doxygen.css" rel="stylesheet" type="text/css"><link href="cpp_ref/tabs.css" rel="stylesheet" type="text/css"><link href="style/adsk.cpm.css" rel="stylesheet" type="text/css"><script language="javascript">var index = 'index.html';</script><script>$(document).ready(function() { yepnope.injectJs("./scripts/ac_common.js"); });</script><script type="text/javascript">
var tocSystemNeedsToBeLoaded = typeof(cpp_ref_adsk_ref_toc) == 'undefined';
var weAreIn21 = $('div#main.view-active').length;
var tocPrefix = '';
if (weAreIn21)
{ tocPrefix = 'cpp_ref/'; }
function cpp_ref_initializeToc(forceTrigger) {
    cpp_ref_adsk_ref_toc.initResizable();
    cpp_ref_adsk_ref_toc.initNavTree('onb_shader_2onb_shader_override_8cpp-example.html', tocPrefix);
    dQuery(document).trigger('toc_initialized');
}
if (tocSystemNeedsToBeLoaded)
{
	yepnope([{
	load:[tocPrefix + 'json3.min.js', tocPrefix + 'jquery.js', tocPrefix + 'ref-toc-controller.js', tocPrefix + 'dynsections.js'],
	complete: function() {
	  if (typeof(dQuery) == 'undefined')
	  {
	    dQuery = jQuery.noConflict(true);
	  }
	  else { jQuery.noConflict(true); }
	  $(document).ready(cpp_ref_initializeToc);
	}
 	}])
}
if (!weAreIn21) { // if in AKN...
$(window).load( function() {
    setTimeout( function() {
        var content = $('body > div').not('#body-content');     // take any divs under body that are not id=body-content
        content.each( function() { 
            $(this).css( { 'padding-left': $(this).css('margin-left') } );       // and if they have any padding-left already, move it to margin-left.
        } );
        var width = cpp_ref_adsk_ref_toc.readFromStorage('width');
        content.css({marginLeft:parseInt(width)+6+"px"});
    }, 100);
} ); 
}
</script><script>$("div#WidgetFloaterPanels,link[href*='microsofttranslator.com'],script[src*='microsofttranslator.com'],script[src*='bing.com']").remove();</script><script type="text/javascript">$("div#navigation,div#breadcrumbs,div#banner").attr("translate","no"); var mtLocation = ((location && location.href && location.href.indexOf('https') == 0)?'https://ssl.microsofttranslator.com':'http://www.microsofttranslator.com')+'/ajax/v3/WidgetV3.ashx?siteData=y5CYlxTRD0znCzRLDwX0Wy7-g1EdC1XA4dSC-Y1LtaeScyli8_Ps5jPKqTr4xKxMI0OOUfkDplvX3uxN0JnPclebSYW8_J1HBzf4VLQEzQ8M4PsYXF_cMyp1Oumaetky&category=5297189e-446b-459e-ae1d-9d0360400781_tech&ctf=True&ui=true&settings=Manual&from=en&hidelanguages='; yepnope.injectJs(mtLocation, function() {}, { charset:'utf-8', type:'text/javascript' } );</script><script>
 if (!tocSystemNeedsToBeLoaded) { cpp_ref_initializeToc(); }
 </script><!-- begin MT -->
<div class="Dark" id="MicrosoftTranslatorWidget" style="position:absolute;right:20px;top:5px;z-index:100;color:white;background-color:#555555;height:58px;overflow:hidden"></div>
<div>
<div class="head">
<h1>onbShader/onbShaderOverride.cpp</h1>
</div>
<div id="top"><!-- Generated by Doxygen 1.8.10 -->
<div class="tabs" id="navrow1">
<ul class="tablist">
<li><a href="./index.html"><span>MainÂ Page</span></a></li>
<li><a href="./pages.html"><span>Topics</span></a></li>
<li><a href="./modules.html"><span>Modules</span></a></li>
<li><a href="./namespaces.html"><span>Namespaces</span></a></li>
<li><a href="./annotated.html"><span>Classes</span></a></li>
<li><a href="./examples.html"><span>Examples</span></a></li>
</ul>
</div>
</div><!-- top -->
<div class="ui-resizable side-nav-resizable" id="side-nav">
<div id="nav-tree">
<div id="nav-tree-contents">
<div class="sync" id="nav-sync"></div>
</div>
</div>
<div class="ui-resizable-handle" id="splitbar" style="-moz-user-select:none;">
</div>
</div>
<div id="doc-content">
<div class="header">
<div class="headertitle">
<div class="title">onbShader/onbShaderOverride.cpp</div> </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">//-</span></div>
<div class="line"><span class="comment">// ===========================================================================</span></div>
<div class="line"><span class="comment">// Copyright 2015 Autodesk, Inc.  All rights reserved.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Use of this software is subject to the terms of the Autodesk license</span></div>
<div class="line"><span class="comment">// agreement provided at the time of installation or download, or which</span></div>
<div class="line"><span class="comment">// otherwise accompanies this software in either electronic or hard copy form.</span></div>
<div class="line"><span class="comment">// ===========================================================================</span></div>
<div class="line"><span class="comment">//+</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include "onbShaderOverride.h"</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MViewport2Renderer.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;maya/MFragmentManager.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// This is the implementation of MPxSurfaceShadingNodeOverride that tells Maya</span></div>
<div class="line"><span class="comment">// how to build and manage a VP2 shading fragment for the onbShader node in the</span></div>
<div class="line"><span class="comment">// DG. Note that the implementation is trivial for the most part. The reason for</span></div>
<div class="line"><span class="comment">// this is because we have made the final fragment graph parameters match in</span></div>
<div class="line"><span class="comment">// name and type to the attributes on the shading node. If that was not the</span></div>
<div class="line"><span class="comment">// case, or if there were paramters without a one-to-one mapping from</span></div>
<div class="line"><span class="comment">// attributes on the node then this class would be more complicated, perhaps</span></div>
<div class="line"><span class="comment">// requiring the implementation of several of the other virtual methods from</span></div>
<div class="line"><span class="comment">// MPxShadingNodeOverride (the base class to MPxSurfaceShadingNodeOverride).</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Here we simply provide the final fragment graph name in fragmentName(),</span></div>
<div class="line"><span class="comment">// and also provide parameter names for certain material properties (color,</span></div>
<div class="line"><span class="comment">// transparency and bump).</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// A static method handles the definition and registration of the actual</span></div>
<div class="line"><span class="comment">// shading fragments and the final fragment graph. Please see the comments in</span></div>
<div class="line"><span class="comment">// registerFragments() for more details.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">const</span> <a name="_a0"></a><a class="code" href="./class_m_string.html">MString</a> onbShaderOverride::sFinalFragmentGraphName(<span class="stringliteral">"onbShaderSurface"</span>);</div>
<div class="line"></div>
<div class="line"><a name="_a1"></a><a class="code" href="./class_m_h_w_render_1_1_m_px_surface_shading_node_override.html">MHWRender::MPxSurfaceShadingNodeOverride</a>* onbShaderOverride::creator(</div>
<div class="line"> <span class="keyword">const</span> <a name="_a2"></a><a class="code" href="./class_m_object.html">MObject</a>&amp; obj)</div>
<div class="line">{</div>
<div class="line"> <span class="keywordflow">return</span> <span class="keyword">new</span> onbShaderOverride(obj);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">onbShaderOverride::onbShaderOverride(<span class="keyword">const</span> <a class="code" href="./class_m_object.html">MObject</a>&amp; obj)</div>
<div class="line">: MPxSurfaceShadingNodeOverride(obj)</div>
<div class="line">, fObject(obj)</div>
<div class="line">{</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">onbShaderOverride::~onbShaderOverride()</div>
<div class="line">{</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="./namespace_m_h_w_render.html#ad970d5c990d4803d0e9d73c1ff4fda49">MHWRender::DrawAPI</a> onbShaderOverride::supportedDrawAPIs()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line"> <span class="comment">// Support all available draw APIs (all fragments have an implementation for</span></div>
<div class="line"> <span class="comment">// each).</span></div>
<div class="line"> <span class="keywordflow">return</span></div>
<div class="line"> <a name="a3"></a><a class="code" href="./namespace_m_h_w_render.html#ad970d5c990d4803d0e9d73c1ff4fda49a72361be679c1aca1c1be5f9b500a3315">MHWRender::kOpenGL</a> |</div>
<div class="line"> <a name="a4"></a><a class="code" href="./namespace_m_h_w_render.html#ad970d5c990d4803d0e9d73c1ff4fda49a90bc0a1678af7ac4d1e62e2e954be4e5">MHWRender::kDirectX11</a> |</div>
<div class="line"> <a name="a5"></a><a class="code" href="./namespace_m_h_w_render.html#ad970d5c990d4803d0e9d73c1ff4fda49aaebf48c70b63878eff38483392f19fb7">MHWRender::kOpenGLCoreProfile</a>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="./class_m_string.html">MString</a> onbShaderOverride::fragmentName()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line"> <span class="comment">// Return the name of the full fragment graph</span></div>
<div class="line"> <span class="keywordflow">return</span> sFinalFragmentGraphName;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="./class_m_string.html">MString</a> onbShaderOverride::primaryColorParameter()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line"> <span class="comment">// Use the color parameter from the our fragment graph as the primary color</span></div>
<div class="line"> <span class="keywordflow">return</span> <span class="stringliteral">"color"</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="./class_m_string.html">MString</a> onbShaderOverride::transparencyParameter()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line"> <span class="comment">// Use the transparency parameter from our fragment graph for transparency</span></div>
<div class="line"> <span class="keywordflow">return</span> <span class="stringliteral">"transparency"</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="./class_m_string.html">MString</a> onbShaderOverride::bumpAttribute()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line"> <span class="comment">// Use the normalCamera attribute to recognize bump connections</span></div>
<div class="line"> <span class="keywordflow">return</span> <span class="stringliteral">"normalCamera"</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">// Static fragment registration/deregistration methods called from plugin</span></div>
<div class="line"><span class="comment">// init/unint functions. Only need to be called once.</span></div>
<div class="line"><a name="_a6"></a><a class="code" href="./class_m_status.html">MStatus</a> onbShaderOverride::registerFragments()</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// Get fragment manager for registration</span></div>
<div class="line"> <a name="_a7"></a><a class="code" href="./class_m_h_w_render_1_1_m_fragment_manager.html">MHWRender::MFragmentManager</a>* fragmentMgr =</div>
<div class="line"> <a name="a8"></a><a class="code" href="./class_m_h_w_render_1_1_m_renderer.html#a4678a72ac6959ed21d422d27928d0343">MHWRender::MRenderer::theRenderer</a>()</div>
<div class="line">            ? <a class="code" href="./class_m_h_w_render_1_1_m_renderer.html#a4678a72ac6959ed21d422d27928d0343">MHWRender::MRenderer::theRenderer</a>()-&gt;<a name="a9"></a><a class="code" href="./class_m_h_w_render_1_1_m_renderer.html#a0f42783e8eee6f472d6bbb2acb6b2f2d">getFragmentManager</a>()</div>
<div class="line">            : NULL;</div>
<div class="line"> <span class="comment">// No fragment manager, fail</span></div>
<div class="line"> <span class="keywordflow">if</span> (!fragmentMgr) <span class="keywordflow">return</span> <a name="a10"></a><a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80a1ef6c2d725fb4bec3e7e840d28adbc00">MS::kFailure</a>;</div>
<div class="line"> <span class="comment">// Fragments are already registered, return success</span></div>
<div class="line"> <span class="keywordflow">if</span> (fragmentMgr-&gt;<a name="a11"></a><a class="code" href="./class_m_h_w_render_1_1_m_fragment_manager.html#af82d71b3a71c8752d51d0a9cb6081877">hasFragment</a>(sFinalFragmentGraphName)) <span class="keywordflow">return</span> <a name="a12"></a><a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80af0536797208144380691e2b376ffc1d1">MS::kSuccess</a>;</div>
<div class="line"></div>
<div class="line"> <a class="code" href="./class_m_string.html">MString</a> fragmentName;</div>
<div class="line"> <span class="keywordtype">char</span>* fragmentBody = NULL;</div>
<div class="line"></div>
<div class="line"> <span class="comment">// ------------------------------------------------------------------------</span></div>
<div class="line"> <span class="comment">// Pass-through fragment for float3 type, used to provide clarity and as to</span></div>
<div class="line"> <span class="comment">// where duplicated parameters come from (in this case it is used three</span></div>
<div class="line"> <span class="comment">// times, once each for Nw, Vw and Lw, which are all used on both</span></div>
<div class="line"> <span class="comment">// onbShaderGeom and onbDiffuse.</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line">    fragmentName = <span class="stringliteral">"onbFloat3PassThrough"</span>;</div>
<div class="line">    fragmentBody =</div>
<div class="line"> <span class="stringliteral">"&lt;fragment uiName=\"onbFloat3PassThrough\" name=\"onbFloat3PassThrough\" type=\"plumbing\" class=\"ShadeFragment\" version=\"1.0\"&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;description&gt;&lt;![CDATA[Pass-through fragment for float3 type.]]&gt;&lt;/description&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;properties&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"input\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/properties&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;values&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/values&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;outputs&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"output\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/outputs&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;implementation render=\"OGSRenderer\" language=\"Cg\" lang_version=\"2.1\"&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;function_name val=\"onbFloat3PassThrough\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;source&gt;&lt;![CDATA[ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"float3 onbFloat3PassThrough(float3 value) \r\n"</span></div>
<div class="line"> <span class="stringliteral">"{ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   return value; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"} \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       ]]&gt;&lt;/source&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;implementation render=\"OGSRenderer\" language=\"HLSL\" lang_version=\"11.0\"&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;function_name val=\"onbFloat3PassThrough\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;source&gt;&lt;![CDATA[ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"float3 onbFloat3PassThrough(float3 value) \r\n"</span></div>
<div class="line"> <span class="stringliteral">"{ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   return value; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"} \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       ]]&gt;&lt;/source&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;implementation render=\"OGSRenderer\" language=\"GLSL\" lang_version=\"3.0\"&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;function_name val=\"onbFloat3PassThrough\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;source&gt;&lt;![CDATA[ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"vec3 onbFloat3PassThrough(vec3 value) \r\n"</span></div>
<div class="line"> <span class="stringliteral">"{ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   return value; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"} \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       ]]&gt;&lt;/source&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"&lt;/fragment&gt; \r\n"</span>;</div>
<div class="line"> <span class="keywordflow">if</span> (fragmentName != fragmentMgr-&gt;<a name="a13"></a><a class="code" href="./class_m_h_w_render_1_1_m_fragment_manager.html#a221c1b902178b12d827dcae51fdca4c8">addShadeFragmentFromBuffer</a>(fragmentBody, <span class="keyword">false</span>)) <span class="keywordflow">return</span> <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80a1ef6c2d725fb4bec3e7e840d28adbc00">MS::kFailure</a>;</div>
<div class="line"></div>
<div class="line"> <span class="comment">// ------------------------------------------------------------------------</span></div>
<div class="line"> <span class="comment">// Fragment to pre-compute some dot products needed by diffuse and specular</span></div>
<div class="line"> <span class="comment">// computations. Results are packed into a float4.</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line">    fragmentName = <span class="stringliteral">"onbShaderGeom"</span>;</div>
<div class="line">    fragmentBody =</div>
<div class="line"> <span class="stringliteral">"&lt;fragment uiName=\"onbShaderGeom\" name=\"onbShaderGeom\" type=\"plumbing\" class=\"ShadeFragment\" version=\"1.0\"&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;description&gt;&lt;![CDATA[Computes shader geometric components (dot products)]]&gt;&lt;/description&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;properties&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"Nw\" flags=\"varyingInputParam\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"Lw\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"HLw\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"Vw\" flags=\"varyingInputParam\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/properties&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;values&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"Lw\" value=\"0.0,0.0,0.0\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"HLw\" value=\"0.0,0.0,0.0\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/values&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;outputs&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float4 name=\"onbShaderGeom\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/outputs&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;implementation render=\"OGSRenderer\" language=\"Cg\" lang_version=\"2.1\"&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;function_name val=\"onbShaderGeom\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;source&gt;&lt;![CDATA[ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"float4 onbShaderGeom( \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 Nw, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 Lw, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 HLw, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 Vw) \r\n"</span></div>
<div class="line"> <span class="stringliteral">"{ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 Hw = normalize(HLw + Vw); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float NL = saturate(dot(Nw, Lw)); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float NV = saturate(dot(Nw, Vw)); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float NH = saturate(dot(Nw, Hw)); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float VH = dot(Vw, Hw); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   return float4(NL, NV, NH, VH); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"} \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       ]]&gt;&lt;/source&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;implementation render=\"OGSRenderer\" language=\"HLSL\" lang_version=\"11.0\"&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;function_name val=\"onbShaderGeom\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;source&gt;&lt;![CDATA[ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"float4 onbShaderGeom( \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 Nw, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 Lw, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 HLw, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 Vw) \r\n"</span></div>
<div class="line"> <span class="stringliteral">"{ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 Hw = normalize(HLw + Vw); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float NL = saturate(dot(Nw, Lw)); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float NV = saturate(dot(Nw, Vw)); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float NH = saturate(dot(Nw, Hw)); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float VH = dot(Vw, Hw); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   return float4(NL, NV, NH, VH); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"} \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       ]]&gt;&lt;/source&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;implementation render=\"OGSRenderer\" language=\"GLSL\" lang_version=\"3.0\"&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;function_name val=\"onbShaderGeom\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;source&gt;&lt;![CDATA[ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"vec4 onbShaderGeom( \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   vec3 Nw, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   vec3 Lw, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   vec3 HLw, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   vec3 Vw) \r\n"</span></div>
<div class="line"> <span class="stringliteral">"{ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   vec3 Hw = normalize(HLw + Vw); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float NL = saturate(dot(Nw, Lw)); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float NV = saturate(dot(Nw, Vw)); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float NH = saturate(dot(Nw, Hw)); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float VH = dot(Vw, Hw); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   return vec4(NL, NV, NH, VH); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"} \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       ]]&gt;&lt;/source&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"&lt;/fragment&gt; \r\n"</span>;</div>
<div class="line"> <span class="keywordflow">if</span> (fragmentName != fragmentMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_fragment_manager.html#a221c1b902178b12d827dcae51fdca4c8">addShadeFragmentFromBuffer</a>(fragmentBody, <span class="keyword">false</span>)) <span class="keywordflow">return</span> <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80a1ef6c2d725fb4bec3e7e840d28adbc00">MS::kFailure</a>;</div>
<div class="line"></div>
<div class="line"> <span class="comment">// ------------------------------------------------------------------------</span></div>
<div class="line"> <span class="comment">// Fragment to compute the diffuse contribution for shading for a single</span></div>
<div class="line"> <span class="comment">// light source. Implements the simplified Oren-Nayar computation  based on</span></div>
<div class="line"> <span class="comment">//   Engel, Wolfgang et al. Programming Vertex, Geometry, and Pixel Shaders</span></div>
<div class="line"> <span class="comment">//   http://content.gpwiki.org/index.php/D3DBook:(Lighting)_Oren-Nayar</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line">    fragmentName = <span class="stringliteral">"onbDiffuse"</span>;</div>
<div class="line">    fragmentBody =</div>
<div class="line"> <span class="stringliteral">"&lt;fragment uiName=\"onbDiffuse\" name=\"onbDiffuse\" type=\"plumbing\" class=\"ShadeFragment\" version=\"1.0\"&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;description&gt;&lt;![CDATA[Computes Oren-Nayar diffuse component]]&gt;&lt;/description&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;properties&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float4 name=\"shaderGeomInput\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"Nw\" flags=\"varyingInputParam\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"Lw\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"Vw\" flags=\"varyingInputParam\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"diffuseI\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float name=\"roughness\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/properties&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;values&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float4 name=\"shaderGeomInput\" value=\"0.0,0.0,0.0,0.0\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"Lw\" value=\"0.0,0.0,0.0\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"diffuseI\" value=\"0.0,0.0,0.0\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float name=\"roughness\" value=\"0.3\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/values&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;outputs&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"onbDiffuse\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/outputs&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;implementation render=\"OGSRenderer\" language=\"Cg\" lang_version=\"2.1\"&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;function_name val=\"onbDiffuse\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;source&gt;&lt;![CDATA[ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"float3 onbDiffuse( \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float4 NL_NV_NH_VH, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 Nw, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 Lw, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 Vw, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 diffuseI, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float roughness) \r\n"</span></div>
<div class="line"> <span class="stringliteral">"{ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   // GPU implementation of Oren-Nayar computation from: \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   //  Engel, Wolfgang et al.: Programming Vertex, Geometry, and Pixel Shaders \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   //  http://content.gpwiki.org/index.php/D3DBook:(Lighting)_Oren-Nayar \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float acosNV = acos(NL_NV_NH_VH.y); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float acosNL = acos(NL_NV_NH_VH.x); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float alpha = max(acosNV, acosNL); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float beta = min(acosNV, acosNL); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float gamma = dot(Vw - Nw*NL_NV_NH_VH.y, Lw - Nw*NL_NV_NH_VH.x); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float roughnessSq = roughness*roughness; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float A = 1.0f - 0.5f*(roughnessSq/(roughnessSq + 0.57f)); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float B = 0.45f*(roughnessSq/(roughnessSq + 0.09f)); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float C = sin(alpha)*tan(beta); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float factor = max(0.0f, NL_NV_NH_VH.x)*(A + B*max(0.0f, gamma)*C); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   return factor*diffuseI; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"} \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       ]]&gt;&lt;/source&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;implementation render=\"OGSRenderer\" language=\"HLSL\" lang_version=\"11.0\"&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;function_name val=\"onbDiffuse\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;source&gt;&lt;![CDATA[ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"float3 onbDiffuse( \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float4 NL_NV_NH_VH, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 Nw, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 Lw, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 Vw, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 diffuseI, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float roughness) \r\n"</span></div>
<div class="line"> <span class="stringliteral">"{ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   // GPU implementation of Oren-Nayar computation from: \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   //  Engel, Wolfgang et al.: Programming Vertex, Geometry, and Pixel Shaders \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   //  http://content.gpwiki.org/index.php/D3DBook:(Lighting)_Oren-Nayar \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float acosNV = acos(NL_NV_NH_VH.y); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float acosNL = acos(NL_NV_NH_VH.x); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float alpha = max(acosNV, acosNL); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float beta = min(acosNV, acosNL); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float gamma = dot(Vw - Nw*NL_NV_NH_VH.y, Lw - Nw*NL_NV_NH_VH.x); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float roughnessSq = roughness*roughness; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float A = 1.0f - 0.5f*(roughnessSq/(roughnessSq + 0.57f)); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float B = 0.45f*(roughnessSq/(roughnessSq + 0.09f)); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float C = sin(alpha)*tan(beta); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float factor = max(0.0f, NL_NV_NH_VH.x)*(A + B*max(0.0f, gamma)*C); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   return factor*diffuseI; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"} \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       ]]&gt;&lt;/source&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;implementation render=\"OGSRenderer\" language=\"GLSL\" lang_version=\"3.0\"&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;function_name val=\"onbDiffuse\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;source&gt;&lt;![CDATA[ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"vec3 onbDiffuse( \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   vec4 NL_NV_NH_VH, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   vec3 Nw, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   vec3 Lw, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   vec3 Vw, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   vec3 diffuseI, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float roughness) \r\n"</span></div>
<div class="line"> <span class="stringliteral">"{ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   // GPU implementation of Oren-Nayar computation from: \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   //  Engel, Wolfgang et al.: Programming Vertex, Geometry, and Pixel Shaders \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   //  http://content.gpwiki.org/index.php/D3DBook:(Lighting)_Oren-Nayar \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float acosNV = acos(NL_NV_NH_VH.y); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float acosNL = acos(NL_NV_NH_VH.x); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float alpha = max(acosNV, acosNL); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float beta = min(acosNV, acosNL); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float gamma = dot(Vw - Nw*NL_NV_NH_VH.y, Lw - Nw*NL_NV_NH_VH.x); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float roughnessSq = roughness*roughness; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float A = 1.0f - 0.5f*(roughnessSq/(roughnessSq + 0.57f)); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float B = 0.45f*(roughnessSq/(roughnessSq + 0.09f)); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float C = sin(alpha)*tan(beta); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float factor = max(0.0f, NL_NV_NH_VH.x)*(A + B*max(0.0f, gamma)*C); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   return factor*diffuseI; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"} \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       ]]&gt;&lt;/source&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"&lt;/fragment&gt; \r\n"</span>;</div>
<div class="line"> <span class="keywordflow">if</span> (fragmentName != fragmentMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_fragment_manager.html#a221c1b902178b12d827dcae51fdca4c8">addShadeFragmentFromBuffer</a>(fragmentBody, <span class="keyword">false</span>)) <span class="keywordflow">return</span> <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80a1ef6c2d725fb4bec3e7e840d28adbc00">MS::kFailure</a>;</div>
<div class="line"></div>
<div class="line"> <span class="comment">// ------------------------------------------------------------------------</span></div>
<div class="line"> <span class="comment">// Fragment to compute the specular contribution for shading for a single</span></div>
<div class="line"> <span class="comment">// light source. Implements blinn specular computation.</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line">    fragmentName = <span class="stringliteral">"onbSpecular"</span>;</div>
<div class="line">    fragmentBody =</div>
<div class="line"> <span class="stringliteral">"&lt;fragment uiName=\"onbSpecular\" name=\"onbSpecular\" type=\"plumbing\" class=\"ShadeFragment\" version=\"1.0\"&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;description&gt;&lt;![CDATA[Computes blinn specular component]]&gt;&lt;/description&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;properties&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"specularI\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float4 name=\"shaderGeomInput\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"specularColor\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float name=\"eccentricity\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float name=\"specularRollOff\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/properties&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;values&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"specularI\" value=\"0.0,0.0,0.0\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float4 name=\"shaderGeomInput\" value=\"0.0,0.0,0.0,0.0\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"specularColor\" value=\"1.0,1.0,1.0\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float name=\"eccentricity\" value=\"0.1\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float name=\"specularRollOff\" value=\"0.7\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/values&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;outputs&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"onbSpecular\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/outputs&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;implementation render=\"OGSRenderer\" language=\"Cg\" lang_version=\"2.1\"&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;function_name val=\"onbSpecular\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;source&gt;&lt;![CDATA[ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"float3 onbSpecular( \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 specularI, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float4 NL_NV_NH_VH, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 specularColor, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float ecc, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float rolloff) \r\n"</span></div>
<div class="line"> <span class="stringliteral">"{ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   const float eps = 0.00001f; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float ecc2 = ecc * ecc - 1.0f; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float NH = NL_NV_NH_VH.z; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float d = (ecc2 + 1.0f) / (1.0f + ecc2 * NH * NH); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   d *= 2.0f * d * d; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float NL = NL_NV_NH_VH.x; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float NV = NL_NV_NH_VH.y; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float VH = NL_NV_NH_VH.w + eps; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   NH *= 0.5f; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float g = saturate(min(NH*NV/VH, NH*NL/VH)); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float k = max((1.0f - NV), (1.0f - NL)); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   k = k * k * k; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float f = k + (1.0f - k) * rolloff; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   return specularI * saturate(d * f * g) * specularColor; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"} \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       ]]&gt;&lt;/source&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;implementation render=\"OGSRenderer\" language=\"HLSL\" lang_version=\"11.0\"&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;function_name val=\"onbSpecular\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;source&gt;&lt;![CDATA[ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"float3 onbSpecular( \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 specularI, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float4 NL_NV_NH_VH, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 specularColor, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float ecc, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float rolloff) \r\n"</span></div>
<div class="line"> <span class="stringliteral">"{ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   const float eps = 0.00001f; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float ecc2 = ecc * ecc - 1.0f; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float NH = NL_NV_NH_VH.z; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float d = (ecc2 + 1.0f) / (1.0f + ecc2 * NH * NH); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   d *= 2.0f * d * d; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float NL = NL_NV_NH_VH.x; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float NV = NL_NV_NH_VH.y; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float VH = NL_NV_NH_VH.w + eps; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   NH *= 0.5f; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float g = saturate(min(NH*NV/VH, NH*NL/VH)); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float k = max((1.0f - NV), (1.0f - NL)); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   k = k * k * k; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float f = k + (1.0f - k) * rolloff; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   return specularI * saturate(d * f * g) * specularColor; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"} \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       ]]&gt;&lt;/source&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;implementation render=\"OGSRenderer\" language=\"GLSL\" lang_version=\"3.0\"&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;function_name val=\"onbSpecular\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;source&gt;&lt;![CDATA[ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"vec3 onbSpecular( \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   vec3 specularI, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   vec4 NL_NV_NH_VH, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   vec3 specularColor, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float ecc, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float rolloff) \r\n"</span></div>
<div class="line"> <span class="stringliteral">"{ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   const float eps = 0.00001f; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float ecc2 = ecc * ecc - 1.0f; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float NH = NL_NV_NH_VH.z; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float d = (ecc2 + 1.0f) / (1.0f + ecc2 * NH * NH); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   d *= 2.0f * d * d; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float NL = NL_NV_NH_VH.x; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float NV = NL_NV_NH_VH.y; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float VH = NL_NV_NH_VH.w + eps; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   NH *= 0.5f; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float g = saturate(min(NH*NV/VH, NH*NL/VH)); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float k = max((1.0f - NV), (1.0f - NL)); \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   k = k * k * k; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float f = k + (1.0f - k) * rolloff; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   return specularI * saturate(d * f * g) * specularColor; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"} \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       ]]&gt;&lt;/source&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"&lt;/fragment&gt; \r\n"</span>;</div>
<div class="line"> <span class="keywordflow">if</span> (fragmentName != fragmentMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_fragment_manager.html#a221c1b902178b12d827dcae51fdca4c8">addShadeFragmentFromBuffer</a>(fragmentBody, <span class="keyword">false</span>)) <span class="keywordflow">return</span> <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80a1ef6c2d725fb4bec3e7e840d28adbc00">MS::kFailure</a>;</div>
<div class="line"></div>
<div class="line"> <span class="comment">// ------------------------------------------------------------------------</span></div>
<div class="line"> <span class="comment">// Light accumulator fragment. Special fragment type that instructs the</span></div>
<div class="line"> <span class="comment">// underlying fragment system to generate a light loop based on input from</span></div>
<div class="line"> <span class="comment">// the auto-generated "selector" fragment. The value "mayaLightSelector16"</span></div>
<div class="line"> <span class="comment">// gives the name of the selector fragment. This fragment is created by</span></div>
<div class="line"> <span class="comment">// Maya and connected at the appropriate time. The selector fragment</span></div>
<div class="line"> <span class="comment">// supports up to 16 lights. This accumulator fragment causes the</span></div>
<div class="line"> <span class="comment">// generation of code that computes the diffuse and specular shading for</span></div>
<div class="line"> <span class="comment">// each light and then gathers the scaled sum of the results.</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line">    fragmentName = <span class="stringliteral">"onb16LightAccum"</span>;</div>
<div class="line">    fragmentBody =</div>
<div class="line"> <span class="stringliteral">"&lt;fragment uiName=\"onb16LightAccum\" name=\"onb16LightAccum\" type=\"accum\" class=\"ShadeFragment\" version=\"1.0\"&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;description&gt;&lt;![CDATA[Accumulates specular &amp; diffuse irradiance for 16 lights]]&gt;&lt;/description&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;properties&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"scaledDiffuse\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"scaledSpecular\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;string name=\"selector\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/properties&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;values&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;string name=\"selector\" value=\"mayaLightSelector16\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/values&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;outputs&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;alias name=\"scaledDiffuse\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;alias name=\"scaledSpecular\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/outputs&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"&lt;/fragment&gt; \r\n"</span>;</div>
<div class="line"> <span class="keywordflow">if</span> (fragmentName != fragmentMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_fragment_manager.html#a221c1b902178b12d827dcae51fdca4c8">addShadeFragmentFromBuffer</a>(fragmentBody, <span class="keyword">false</span>)) <span class="keywordflow">return</span> <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80a1ef6c2d725fb4bec3e7e840d28adbc00">MS::kFailure</a>;</div>
<div class="line"></div>
<div class="line"> <span class="comment">// ------------------------------------------------------------------------</span></div>
<div class="line"> <span class="comment">// Struct declaration fragment. This fragment provides the declaration of</span></div>
<div class="line"> <span class="comment">// the output structure of the onb fragment graph giving support for</span></div>
<div class="line"> <span class="comment">// multiple outputs. The struct fragment must be a part of the final</span></div>
<div class="line"> <span class="comment">// fragment graph in order to ensure that the fragment system includes</span></div>
<div class="line"> <span class="comment">// the declaration of the struct in the final effect.</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line">    fragmentName = <span class="stringliteral">"onbShaderOutput"</span>;</div>
<div class="line">    fragmentBody =</div>
<div class="line"> <span class="stringliteral">"&lt;fragment uiName=\"onbShaderOutput\" name=\"onbShaderOutput\" type=\"structure\" class=\"ShadeFragment\" version=\"1.0\"&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;description&gt;&lt;![CDATA[Struct output for onb shader]]&gt;&lt;/description&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;properties&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;struct name=\"onbShaderOutput\" struct_name=\"onbShaderOutput\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/properties&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;values&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/values&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;outputs&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;alias name=\"onbShaderOutput\" struct_name=\"onbShaderOutput\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"outColor\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"outTransparency\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float4 name=\"outSurfaceFinal\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/outputs&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;implementation render=\"OGSRenderer\" language=\"Cg\" lang_version=\"2.1\"&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;function_name val=\"\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;declaration name=\"onbShaderOutput\"&gt;&lt;![CDATA[ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"struct onbShaderOutput \r\n"</span></div>
<div class="line"> <span class="stringliteral">"{ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 outColor; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 outTransparency; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float4 outSurfaceFinal; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"}; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       ]]&gt;&lt;/declaration&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;implementation render=\"OGSRenderer\" language=\"HLSL\" lang_version=\"11.0\"&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;function_name val=\"\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;declaration name=\"onbShaderOutput\"&gt;&lt;![CDATA[ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"struct onbShaderOutput \r\n"</span></div>
<div class="line"> <span class="stringliteral">"{ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 outColor; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 outTransparency; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float4 outSurfaceFinal; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"}; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       ]]&gt;&lt;/declaration&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;implementation render=\"OGSRenderer\" language=\"GLSL\" lang_version=\"3.0\"&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;function_name val=\"\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;declaration name=\"onbShaderOutput\"&gt;&lt;![CDATA[ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"struct onbShaderOutput \r\n"</span></div>
<div class="line"> <span class="stringliteral">"{ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   vec3 outColor; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   vec3 outTransparency; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   vec4 outSurfaceFinal; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"}; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       ]]&gt;&lt;/declaration&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"&lt;/fragment&gt; \r\n"</span>;</div>
<div class="line"> <span class="keywordflow">if</span> (fragmentName != fragmentMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_fragment_manager.html#a221c1b902178b12d827dcae51fdca4c8">addShadeFragmentFromBuffer</a>(fragmentBody, <span class="keyword">false</span>)) <span class="keywordflow">return</span> <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80a1ef6c2d725fb4bec3e7e840d28adbc00">MS::kFailure</a>;</div>
<div class="line"></div>
<div class="line"> <span class="comment">// ------------------------------------------------------------------------</span></div>
<div class="line"> <span class="comment">// Combiner fragment. Takes in the computed diffuse and specular results</span></div>
<div class="line"> <span class="comment">// and combines them with the other shader parameters to produce the final</span></div>
<div class="line"> <span class="comment">// color, transparency and surface (color with alpha) values. The ambientIn</span></div>
<div class="line"> <span class="comment">// parameter is populated by Maya with level of global ambient light based</span></div>
<div class="line"> <span class="comment">// on ambient lights in the scene.</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line">    fragmentName = <span class="stringliteral">"onbCombiner"</span>;</div>
<div class="line">    fragmentBody =</div>
<div class="line"> <span class="stringliteral">"&lt;fragment uiName=\"onbCombiner\" name=\"onbCombiner\" type=\"plumbing\" class=\"ShadeFragment\" version=\"1.0\"&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;description&gt;&lt;![CDATA[Combines ambient, diffuse, specular components additively]]&gt;&lt;/description&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;properties&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"diffuseIrradIn\" flags=\"constantParam\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"specularIrradIn\" flags=\"constantParam\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"color\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"transparency\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"ambientColor\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"ambientIn\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"incandescence\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/properties&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;values&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"diffuseIrradIn\" value=\"0.0,0.0,0.0\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"specularIrradIn\" value=\"0.0,0.0,0.0\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"color\" value=\"0.5,0.5,0.5\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"transparency\" value=\"0.0,0.0,0.0\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"ambientColor\" value=\"0.0,0.0,0.0\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"ambientIn\" value=\"0.0,0.0,0.0\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"incandescence\" value=\"0.0,0.0,0.0\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/values&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;outputs&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;struct name=\"onbCombiner\" struct_name=\"onbShaderOutput\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/outputs&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;implementation render=\"OGSRenderer\" language=\"Cg\" lang_version=\"2.1\"&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;function_name val=\"onbCombiner\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;source&gt;&lt;![CDATA[ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"onbShaderOutput onbCombiner( \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 diffuseIrradIn, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 specularIrradIn, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 color, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 transparency, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 ambientColor, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 ambientIn, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 incandescence) \r\n"</span></div>
<div class="line"> <span class="stringliteral">"{ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   onbShaderOutput result; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   result.outColor = (ambientColor+ambientIn)*color; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   result.outColor += diffuseIrradIn*color; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 opacity = saturate(1.0f - transparency);  \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   result.outColor *= opacity; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   result.outColor += specularIrradIn; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   result.outColor += incandescence; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   result.outTransparency = transparency; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   const float3 intenseVec = float3(0.3333, 0.3333, 0.3333);  \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   result.outSurfaceFinal = float4(result.outColor, dot(opacity, intenseVec));  \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   return result; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"} \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       ]]&gt;&lt;/source&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;implementation render=\"OGSRenderer\" language=\"HLSL\" lang_version=\"11.0\"&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;function_name val=\"onbCombiner\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;source&gt;&lt;![CDATA[ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"onbShaderOutput onbCombiner( \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 diffuseIrradIn, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 specularIrradIn, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 color, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 transparency, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 ambientColor, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 ambientIn, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 incandescence) \r\n"</span></div>
<div class="line"> <span class="stringliteral">"{ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   onbShaderOutput result; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   result.outColor = (ambientColor+ambientIn)*color; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   result.outColor += diffuseIrradIn*color; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   float3 opacity = saturate(1.0f - transparency);  \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   result.outColor *= opacity; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   result.outColor += specularIrradIn; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   result.outColor += incandescence; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   result.outTransparency = transparency; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   const float3 intenseVec = float3(0.3333, 0.3333, 0.3333);  \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   result.outSurfaceFinal = float4(result.outColor, dot(opacity, intenseVec));  \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   return result; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"} \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       ]]&gt;&lt;/source&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;implementation render=\"OGSRenderer\" language=\"GLSL\" lang_version=\"3.0\"&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;function_name val=\"onbCombiner\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;source&gt;&lt;![CDATA[ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"onbShaderOutput onbCombiner( \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   vec3 diffuseIrradIn, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   vec3 specularIrradIn, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   vec3 color, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   vec3 transparency, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   vec3 ambientColor, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   vec3 ambientIn, \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   vec3 incandescence) \r\n"</span></div>
<div class="line"> <span class="stringliteral">"{ \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   onbShaderOutput result; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   result.outColor = (ambientColor+ambientIn)*color; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   result.outColor += diffuseIrradIn*color; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   vec3 opacity = saturate(1.0f - transparency);  \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   result.outColor *= opacity; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   result.outColor += specularIrradIn; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   result.outColor += incandescence; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   result.outTransparency = transparency; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   const vec3 intenseVec = vec3(0.3333, 0.3333, 0.3333);  \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   result.outSurfaceFinal = vec4(result.outColor, dot(opacity, intenseVec));  \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   return result; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"} \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       ]]&gt;&lt;/source&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/implementation&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"&lt;/fragment&gt; \r\n"</span>;</div>
<div class="line"> <span class="keywordflow">if</span> (fragmentName != fragmentMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_fragment_manager.html#a221c1b902178b12d827dcae51fdca4c8">addShadeFragmentFromBuffer</a>(fragmentBody, <span class="keyword">false</span>)) <span class="keywordflow">return</span> <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80a1ef6c2d725fb4bec3e7e840d28adbc00">MS::kFailure</a>;</div>
<div class="line"></div>
<div class="line"> <span class="comment">// ------------------------------------------------------------------------</span></div>
<div class="line"> <span class="comment">// Full, final graph made up of previously registered fragments. A picture</span></div>
<div class="line"> <span class="comment">// which flows from top to bottom.</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line"> <span class="comment">//      onbFloat3PassThrough(Nw)--------------------\</span></div>
<div class="line"><span class="comment">    //            |                                     |</span></div>
<div class="line"> <span class="comment">//            |  nbFloat3PassThrough(Vw)---------\  |</span></div>
<div class="line"> <span class="comment">//            |   |                              |  |</span></div>
<div class="line"> <span class="comment">//            |   |    nbFloat3PassThrough(Lw)   |  |</span></div>
<div class="line"> <span class="comment">//            |   |     |       |                |  |</span></div>
<div class="line"> <span class="comment">//            |   |     |       |                |  |</span></div>
<div class="line"> <span class="comment">//            onbShaderGeom     \-------------\  |  |</span></div>
<div class="line"> <span class="comment">//                |    |                      |  |  |</span></div>
<div class="line"> <span class="comment">//                |    \-------------------\  |  |  |</span></div>
<div class="line"> <span class="comment">//                |                        |  |  |  |</span></div>
<div class="line"> <span class="comment">//                |                        |  |  |  |</span></div>
<div class="line"> <span class="comment">//          onbSpecular                    onbDiffuse</span></div>
<div class="line"> <span class="comment">//                     \                  /</span></div>
<div class="line"> <span class="comment">//                      \                /</span></div>
<div class="line"> <span class="comment">//                       onb16LightAccum</span></div>
<div class="line"> <span class="comment">//                              |</span></div>
<div class="line"> <span class="comment">//                         onbCombiner</span></div>
<div class="line"> <span class="comment">//                              |</span></div>
<div class="line"> <span class="comment">//                        onbShaderOutput</span></div>
<div class="line"> <span class="comment">//                              |</span></div>
<div class="line"> <span class="comment">//                        &lt;FINAL RESULT&gt;</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line"> <span class="comment">// Maya's shader translation system will take this graph and connect light</span></div>
<div class="line"> <span class="comment">// information where appropriate, allowing this to be inserted in the body</span></div>
<div class="line"> <span class="comment">// of the light loop.</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line"> <span class="comment">// From Maya's point of view, this graph is fully representative of the</span></div>
<div class="line"> <span class="comment">// associated shading node in the DG. All inputs and outputs on this graph</span></div>
<div class="line"> <span class="comment">// are matched to inputs and outputs on the DG node. Connections to other</span></div>
<div class="line"> <span class="comment">// nodes (input or output) will be mirrored by connections to other</span></div>
<div class="line"> <span class="comment">// fragments using the matching parameters.</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line"> <span class="comment">// The parameters Lw and HLw are automatically hooked up to the appropriate</span></div>
<div class="line"> <span class="comment">// light fragments by Maya. Nw and Vw are varying parameters that are</span></div>
<div class="line"> <span class="comment">// automatically generated by the vertex shader.</span></div>
<div class="line"> <span class="comment">//</span></div>
<div class="line">    fragmentName = sFinalFragmentGraphName;</div>
<div class="line">    fragmentBody =</div>
<div class="line"> <span class="stringliteral">"&lt;fragment_graph name=\"onbShaderSurface\" ref=\"onbShaderSurface\" class=\"FragmentGraph\" version=\"1.0\"&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;fragments&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;fragment_ref name=\"nwPassThrough\" ref=\"onbFloat3PassThrough\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;fragment_ref name=\"vwPassThrough\" ref=\"onbFloat3PassThrough\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;fragment_ref name=\"lwPassThrough\" ref=\"onbFloat3PassThrough\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;fragment_ref name=\"onbShaderGeom\" ref=\"onbShaderGeom\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;fragment_ref name=\"onbDiffuse\" ref=\"onbDiffuse\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;fragment_ref name=\"onbSpecular\" ref=\"onbSpecular\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;fragment_ref name=\"onb16LightAccum\" ref=\"onb16LightAccum\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;fragment_ref name=\"onbCombiner\" ref=\"onbCombiner\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;fragment_ref name=\"onbShaderOutput\" ref=\"onbShaderOutput\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/fragments&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;connections&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;connect from=\"nwPassThrough.output\" to=\"onbDiffuse.Nw\" name=\"Nw\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;connect from=\"vwPassThrough.output\" to=\"onbDiffuse.Vw\" name=\"Vw\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;connect from=\"lwPassThrough.output\" to=\"onbDiffuse.Lw\" name=\"Lw\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;connect from=\"nwPassThrough.output\" to=\"onbShaderGeom.Nw\" name=\"Nw\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;connect from=\"vwPassThrough.output\" to=\"onbShaderGeom.Vw\" name=\"Vw\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;connect from=\"lwPassThrough.output\" to=\"onbShaderGeom.Lw\" name=\"Lw\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;connect from=\"onbShaderGeom.onbShaderGeom\" to=\"onbDiffuse.shaderGeomInput\" name=\"shaderGeomInput\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;connect from=\"onbShaderGeom.onbShaderGeom\" to=\"onbSpecular.shaderGeomInput\" name=\"shaderGeomInput\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;connect from=\"onbDiffuse.onbDiffuse\" to=\"onb16LightAccum.scaledDiffuse\" name=\"scaledDiffuse\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;connect from=\"onbSpecular.onbSpecular\" to=\"onb16LightAccum.scaledSpecular\" name=\"scaledSpecular\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;connect from=\"onb16LightAccum.scaledDiffuse\" to=\"onbCombiner.diffuseIrradIn\" name=\"diffuseIrradIn\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;connect from=\"onb16LightAccum.scaledSpecular\" to=\"onbCombiner.specularIrradIn\" name=\"specularIrradIn\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;connect from=\"onbCombiner.onbCombiner\" to=\"onbShaderOutput.onbShaderOutput\" name=\"onbShaderOutput\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/connections&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;properties&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"Nw\" ref=\"nwPassThrough.input\" semantic=\"Nw\" flags=\"varyingInputParam\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"Vw\" ref=\"vwPassThrough.input\" semantic=\"Vw\" flags=\"varyingInputParam\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"Lw\" ref=\"lwPassThrough.input\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"HLw\" ref=\"onbShaderGeom.HLw\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"diffuseI\" ref=\"onbDiffuse.diffuseI\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float name=\"roughness\" ref=\"onbDiffuse.roughness\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"specularI\" ref=\"onbSpecular.specularI\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"specularColor\" ref=\"onbSpecular.specularColor\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float name=\"eccentricity\" ref=\"onbSpecular.eccentricity\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float name=\"specularRollOff\" ref=\"onbSpecular.specularRollOff\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;string name=\"selector\" ref=\"onb16LightAccum.selector\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"color\" ref=\"onbCombiner.color\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"transparency\" ref=\"onbCombiner.transparency\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"ambientColor\" ref=\"onbCombiner.ambientColor\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"ambientIn\" ref=\"onbCombiner.ambientIn\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"incandescence\" ref=\"onbCombiner.incandescence\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/properties&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;values&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"Lw\" value=\"0.0,0.0,0.0\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"HLw\" value=\"0.0,0.0,0.0\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"diffuseI\" value=\"0.0,0.0,0.0\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float name=\"roughness\" value=\"0.3\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"specularI\" value=\"0.0,0.0,0.0\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"specularColor\" value=\"1.0,1.0,1.0\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float name=\"eccentricity\" value=\"0.1\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float name=\"specularRollOff\" value=\"0.7\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;string name=\"selector\" value=\"mayaLightSelector16\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"color\" value=\"0.5,0.5,0.5\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"transparency\" value=\"0.0,0.0,0.0\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"ambientColor\" value=\"0.0,0.0,0.0\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"ambientIn\" value=\"0.0,0.0,0.0\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;float3 name=\"incandescence\" value=\"0.0,0.0,0.0\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/values&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;outputs&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"       &lt;struct name=\"onbShaderOutput\" ref=\"onbShaderOutput.onbShaderOutput\" /&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"   &lt;/outputs&gt; \r\n"</span></div>
<div class="line"> <span class="stringliteral">"&lt;/fragment_graph&gt; \r\n"</span>;</div>
<div class="line"> <span class="keywordflow">if</span> (fragmentName != fragmentMgr-&gt;<a name="a14"></a><a class="code" href="./class_m_h_w_render_1_1_m_fragment_manager.html#a2264caab6f1d9736fe2e7ccc195e8340">addFragmentGraphFromBuffer</a>(fragmentBody)) <span class="keywordflow">return</span> <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80a1ef6c2d725fb4bec3e7e840d28adbc00">MS::kFailure</a>;</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">return</span> <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80af0536797208144380691e2b376ffc1d1">MS::kSuccess</a>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="./class_m_status.html">MStatus</a> onbShaderOverride::deregisterFragments()</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// Get fragment manager for deregistration</span></div>
<div class="line"> <a class="code" href="./class_m_h_w_render_1_1_m_fragment_manager.html">MHWRender::MFragmentManager</a>* fragmentMgr =</div>
<div class="line"> <a class="code" href="./class_m_h_w_render_1_1_m_renderer.html#a4678a72ac6959ed21d422d27928d0343">MHWRender::MRenderer::theRenderer</a>()</div>
<div class="line">            ? <a class="code" href="./class_m_h_w_render_1_1_m_renderer.html#a4678a72ac6959ed21d422d27928d0343">MHWRender::MRenderer::theRenderer</a>()-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_renderer.html#a0f42783e8eee6f472d6bbb2acb6b2f2d">getFragmentManager</a>()</div>
<div class="line">            : NULL;</div>
<div class="line"> <span class="comment">// No fragment manager, fail</span></div>
<div class="line"> <span class="keywordflow">if</span> (!fragmentMgr) <span class="keywordflow">return</span> <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80a1ef6c2d725fb4bec3e7e840d28adbc00">MS::kFailure</a>;</div>
<div class="line"></div>
<div class="line"> <span class="comment">// Remove fragments from library on plugin unload</span></div>
<div class="line"> <span class="keywordflow">if</span> (!fragmentMgr-&gt;<a name="a15"></a><a class="code" href="./class_m_h_w_render_1_1_m_fragment_manager.html#a0986b6896f4fad94fc61ff750583187f">removeFragment</a>(<span class="stringliteral">"onbFloat3PassThrough"</span>)) <span class="keywordflow">return</span> <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80a1ef6c2d725fb4bec3e7e840d28adbc00">MS::kFailure</a>;</div>
<div class="line"> <span class="keywordflow">if</span> (!fragmentMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_fragment_manager.html#a0986b6896f4fad94fc61ff750583187f">removeFragment</a>(<span class="stringliteral">"onbShaderGeom"</span>)) <span class="keywordflow">return</span> <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80a1ef6c2d725fb4bec3e7e840d28adbc00">MS::kFailure</a>;</div>
<div class="line"> <span class="keywordflow">if</span> (!fragmentMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_fragment_manager.html#a0986b6896f4fad94fc61ff750583187f">removeFragment</a>(<span class="stringliteral">"onbDiffuse"</span>)) <span class="keywordflow">return</span> <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80a1ef6c2d725fb4bec3e7e840d28adbc00">MS::kFailure</a>;</div>
<div class="line"> <span class="keywordflow">if</span> (!fragmentMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_fragment_manager.html#a0986b6896f4fad94fc61ff750583187f">removeFragment</a>(<span class="stringliteral">"onbSpecular"</span>)) <span class="keywordflow">return</span> <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80a1ef6c2d725fb4bec3e7e840d28adbc00">MS::kFailure</a>;</div>
<div class="line"> <span class="keywordflow">if</span> (!fragmentMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_fragment_manager.html#a0986b6896f4fad94fc61ff750583187f">removeFragment</a>(<span class="stringliteral">"onb16LightAccum"</span>)) <span class="keywordflow">return</span> <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80a1ef6c2d725fb4bec3e7e840d28adbc00">MS::kFailure</a>;</div>
<div class="line"> <span class="keywordflow">if</span> (!fragmentMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_fragment_manager.html#a0986b6896f4fad94fc61ff750583187f">removeFragment</a>(<span class="stringliteral">"onbShaderOutput"</span>)) <span class="keywordflow">return</span> <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80a1ef6c2d725fb4bec3e7e840d28adbc00">MS::kFailure</a>;</div>
<div class="line"> <span class="keywordflow">if</span> (!fragmentMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_fragment_manager.html#a0986b6896f4fad94fc61ff750583187f">removeFragment</a>(<span class="stringliteral">"onbCombiner"</span>)) <span class="keywordflow">return</span> <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80a1ef6c2d725fb4bec3e7e840d28adbc00">MS::kFailure</a>;</div>
<div class="line"> <span class="keywordflow">if</span> (!fragmentMgr-&gt;<a class="code" href="./class_m_h_w_render_1_1_m_fragment_manager.html#a0986b6896f4fad94fc61ff750583187f">removeFragment</a>(sFinalFragmentGraphName)) <span class="keywordflow">return</span> <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80a1ef6c2d725fb4bec3e7e840d28adbc00">MS::kFailure</a>;</div>
<div class="line"></div>
<div class="line"> <span class="keywordflow">return</span> <a class="code" href="./class_m_status.html#a02ab596f4febca68da503aaf8dde3a80af0536797208144380691e2b376ffc1d1">MS::kSuccess</a>;</div>
<div class="line">}</div>
<div class="line"></div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<div class="footer-block"><a class="comments-anchor" href="../html/ac.cmtdialog.htm" target="_blank"><span class="comments-link">Please send us your comment about this page</span></a></div><br/></div>
</link></link></link></link></div></body>
</html>
